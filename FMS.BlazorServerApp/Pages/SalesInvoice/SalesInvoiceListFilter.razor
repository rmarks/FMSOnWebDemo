@inject IServiceProvider ServiceProvider

<div>
    @if (Options == null)
    {
        <p class="text-secondary">Loading...</p>
    }
    else
    {
        <div class="form-group">
            <div class="input-group">
                <input class="form-control" type="search" placeholder="Kliendi nimi" @bind="Options.SearchByCustomerName" @onkeyup="SearchKeyPress" />
                <div class="input-group-btn">
                    <button class="btn btn-dark" @onclick="SearchClick">
                        <i class="oi oi-magnifying-glass" title="search" />
                    </button>
                </div>
            </div>
        </div>

        <div class="form-group">
            <div class="input-group">
                <input class="form-control" type="search" placeholder="Saaja nimi" @bind="Options.SearchByConsigneeName" @onkeyup="SearchKeyPress" />
                <div class="input-group-btn">
                    <button class="btn btn-dark" @onclick="SearchClick">
                        <i class="oi oi-magnifying-glass" title="search" />
                    </button>
                </div>
            </div>
        </div>

        <div class="form-check">
            <input class="form-check-input" type="radio" name="Status" id="radio1"
                   value="@InvoiceStatus.All" @onchange="StatusSelectionChanged" checked="@(Options.InvoiceStatus == InvoiceStatus.All)" />
            <label class="form-check-label text-white" for="radio1">Kõik olekud</label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="Status" id="radio2"
                   value="@InvoiceStatus.Open" @onchange="StatusSelectionChanged" checked="@(Options.InvoiceStatus == InvoiceStatus.Open)" />
            <label class="form-check-label text-white" for="radio2">Avatud</label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="Status" id="radio3"
                   value="@InvoiceStatus.Closed" @onchange="StatusSelectionChanged" checked="@(Options.InvoiceStatus == InvoiceStatus.Closed)" />
            <label class="form-check-label text-white" for="radio3">Suletud</label>
        </div>
    }
</div>

@code {
    [Parameter] public SalesInvoiceListOptions Options { get; set; }

    [Parameter] public EventCallback OptionsChanged { get; set; }

    #region event handler
    private void SearchKeyPress(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            SearchClick();
        }
    }

    private void SearchClick()
    {
        OptionsChanged.InvokeAsync();
    }

    private void StatusSelectionChanged(ChangeEventArgs e)
    {
        Options.InvoiceStatus = (InvoiceStatus)Enum.Parse(typeof(InvoiceStatus), e.Value.ToString());
        OptionsChanged.InvokeAsync();
    }
    #endregion
}
